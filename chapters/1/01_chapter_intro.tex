%\newcommand{\etal}{et al. }
%\newcommand{\blob}{\textit{BlobTree }}
%\newcommand{\blobns}{\textit{BlobTree}}


\startfirstchapter{Introduction}
\label{chapter:introduction}
\section{General aim of this Research}
Simulating the behavior of elastic objects in real time and with some level of user interaction is a challenging problem 
with many applications in different areas of research including virtual surgery \cite{Meier2005}. 
In computer graphics, the models used for the construction of objects with deformable behavior are known as deformable models. 
A complete model should be quite realistic, interactive and should enable the user to modify the topology of the objects.
Therefore, there exist a number of contrasting constrains: high fidelity, which in general implies accurate models and high frame rate,
and use of low cost computers. A number of proposals have been recently presented to fulfill these objectives. But even if the efficiency
of the simulation models have been largely improved in the last few years, soft object modelling and deformation remains a rather 
complex task and can be solved in interactive time only on models composed by a few hundreds of cells. In addition, integrating effects
such as cut and lacerations, makes the simulation model more complex. In modern interactive simulation and modelling environments the ability to 
cut 3-dimensional geometry in real-time is of fundamental importance. This creates the need for efficient cutting algorithms that process the 
underlying representation. In surgery simulation, interactive cutting algorithms enable the dynamic simulation of scalpel intersections that open 
immediately behind the scalpel \cite{Nienhuys2001}. Cutting a volumetric mesh under deformation is a non-trivial problem, due to several conflicting
requirements. On the one hand, the cutting process should not create badly shaped elements, which could cause numerical instabilities during deformation
calculation. On the other hand cut trajectory should be closely approximated for realistic appearance. So far, most methods have concentrated only on 
one of these problems. 

Therefore the following major problems are identified in the surgical simulation domain:

\begin{itemize}
 \item Modelling complex tissues that are readily available for simulation \cite{Nealen2006,Meier2005,Gibson1997a}.
 \item Real-time visualization of those tissues \cite{Mario2010PolygonMesh,Bloomenthal1997}.
 \item Performing interactive topological modifications on complex models while under deformation \cite{Jin2013,Wu2011,Courtecuisse2010a,Jerabkova2010}. 
\end{itemize}

We present a comprehensive solution to these problems as following. 
First, our proposed modelling solution captures the key advantages found in volumetric modelling approaches using 
implicit surfaces \cite{Bloomenthal1997, Wyvill1986, Wyvill1999, Wyvill1996, Wyvill1997, Schmidt2006, Bernhardt2010a}. Automatic blending and compact 
representation are the major benefits of using implicit surfaces for modelling. In addition, the ability to perform inside-outside tests 
easily is an inherent advantage in implicit models when implementing physically based simulations requiring collision tests. 
The \blob \cite{Wyvill1999} combined blending, affine transformations and constructive solid geometry (CSG) operators in a 
comprehensive and compact scene graph data-structure. \blob provides the ability to create complex models incrementally \cite{Schmidt2006}. 

Secondly we propose a solution for high performance and scalable visualization of complex models created by \blob method.
Volumetric models in general are often several orders of magnitude slower during visualization \cite{Bloomenthal1990a, Bloomenthal1997}.
We proposed a data-driven algorithm for rendering complex implicit models in real-time on multi-core processors \cite{Shirazian2012}, later, we 
fine tuned that algorithm for running on many core architectures such as the ones in high-end graphical processing units (GPUs). 

Third, we take a different approach to develop a stable and realistic cutting system. Our GPU-assisted interactive cutting algorithm allows
arbitrary cuts in the model and can enable many scenarios for tissue manipulation while under deformations. 

In what follows, the implicit modelling approach to deformable tissue design will be studied. To achieve the initial goal of this research, a
computational framework for designing, rendering and animating deformable tissues has been developed and the details of the process is documented 
in the following chapters. 


\section{Deformable Models}
Deformable models can be defined in either one dimension (lines and curves), two dimensions (surfaces), or three dimensions (solid objects). 
Essentially, they are applied in three different areas of research \cite{Meier2005}: 

\begin{itemize}
 \item Object modelling for pre-computed animations \cite{coquillart1990extended, hsu1992direct}.
 \item Image segmentation (automatic 2D interpretation of the images provided by a camera or 3D reconstruction of organs from medical MRI 
 or CT scans) \cite{neveu1994recovery}.
 \item Interactive medical simulations i.e. to emulate the deformational behavior of non-rigid objects due to external influences.
\end{itemize}

Our solution is targeted for the last area where it can be used both in deferred application like surgery planning (e.g., simulation of the 
outcome of craniofacial surgery) \cite{bro1995modelling, keeve1996craniofacial} and real-time applications 
including image guided surgery \cite{Szekely2000}, minimally-invasive or tele-surgery. 


There is no single deformable model that is appropriate for all of the above mentioned 
problems. Instead, there are a variety of methods that are optimized in different ways to meet specific 
needs. 
Current deformable model solutions trade precision in exchange with real-time response.
Even though real-time applications of deformable models are becoming more and more frequent, 
in many cases, the governing prerequisite for the simulation of 
mechanical deformations has been interactivity rather than precision. In addition to that, many of the modelled objects like garments or soft 
tissues do not possess easily describable properties. Consequently, other approaches must to be found 
\cite{bro1998finite}. Important progress in the field of deformable models has been made since the emergence of surgery 
simulation, with one of the first contributors being Cover et al. \cite{cover1993interactively}. 


% move to the section in background
This is mostly due to the extreme prerequisites 
as far as computation time, complex properties of the simulated soft tissues, and intricate interactions with the virtual instruments are concerned. 
In fact, there have been many different points of departure in the research of adequate deformable models, focusing on anatomies and surgical techniques 
that are as different from each other as are eye surgery \cite{cai2001parametric, sagar1994virtual}, knee arthroscopy \cite{gibson1997simulating, 
hoffman1998commercially}, or hepatic laparoscopy \cite{cotin1999real}. The deformable models developed in this context can be divided into three basic groups: 

\begin{enumerate}
 \item The ad-hoc heuristic methods
 \item Simplified continuum-mechanical model
 \item Hybrid methods from the combination of 1 and 2
\end{enumerate}



\section{Motivation}

%%these bits should go under requirements
Laparoscopic surgery brought new technologies into the operating room and created a 
distance between the surgeon and the patient. More recently, other minimally invasive techniques have 
been proposed, such as natural orifice transluminal endoscopic surgery, which can be considered as an 
evolution of laparoscopic surgery. Laparoscopy requires surgeons to acquire new skills, and adapt 
to changes from conventional open surgery e.g. amplified tremor, diminished tactile sensation, loss of 
depth perception.  Without open organ surgery, modern surgeons do not get 
training in the motor skills of the previous generation. Thus there is a 
motivation to develop realistic surgical simulations using 
real-time deformable models, and haptic rendering for further realism \cite{Lin2004}. 
The following benefits have been reported from 
using surgical simulation systems:  \cite{}

\begin{itemize}
 \item Systematic training and objective assessment of technical competence
 \item Skills learned thanks to the simulator are transferable to the operating room
 \item The ability to create patient-specific simulations (i.e. rare pathological cases or when the best surgical strategy is unclear.)
 \item The ability to use augmented reality for image-guided surgery (i.e. to improve the accuracy and limit the adverse effects of surgery)
\end{itemize}

%These are the benfits
In order to achieve these benefits, accurate, real-time bio-mechanical models are needed together
with interactions with medical devices. Such interactions involve tissue manipulation and tissue dissection. 

In this context, modelling and high-performance rendering of soft-tissues are the core requirements for 
a simulation scenario. The development of fast algorithms to compute the deformation, contact response, 
cutting and haptic feedback of soft tissues could enable a number of the aforementioned applications.


\section{Limitation of Current Models}
\label{sec:limitationsOfCurrentModels}
%%Requirements listed below and then 

The requirements listed below are considered in our design of a robust deformable 
model for surgical simulations:

\begin{itemize}
  \item Anatomical models and tissue properties need to be patient-specific and 
obtained without complex additional procedures
  \item Soft tissue behavior needs to be realistic and demonstrate a predictive capability, yet it should be 
  compatible with real-time computation
  \item Interactions with the surrounding anatomy and with medical devices need to involve advanced 
  contact models that can be computed in real-time
  \item The different types of dissection performed on soft tissues should be simulated
  \item Realistic visual and haptic feedback should be provided to create a higher level of immersion, in 
  particular during training sessions
\end{itemize}

%%Chapter \ref{chapter:background} will provide more details on the state of the art techniques in soft tissue modelling. 

%note to self
Among the existing approaches we can cite methods based on spring-mass networks, methods based 
on linear elasticity, and explicit finite element models for non-linear materials 
\cite{Gibson1997a,Meier2005}. In chapter \ref{chapter:background} we discuss these methods in detail.  

Mass-spring networks are quite simple to implement and very fast to compute, but they fail to properly 
characterize soft tissues deformation as they introduce artificial anisotropy through the choice of the 
mesh, and make it difficult to relate spring stiffness to material properties such as Young's modulus 
\cite{Courtecuisse2010}.

Most methods assume Linear elasticity based on small displacements and pre-computed 
response values to accelerate the computations. The small strain assumption is very restrictive. In 
addition, during any topological modifications e.g. in cutting, the pre-computed values 
have to be recalculated which masks their effectiveness in the overall performance of the system.

Cutting deformable tissues is one of the most sought after features in a surgical simulator. In an interactive 
system with high expectations of realism and performance, the implementation of topological 
modifications can become very complex. The proposed solutions suffer from smoothness of the cutting 
plane or slower solve time due to lots of extra nodes added to the system. In chapter 
\ref{chapter:Cutting} we review all the related work in this topic and present our high performance 
cutting algorithm which is built into our physically-based simulation system.


\section{Contributions}
\label{sec:contributions}
Contributions described in this thesis fall into four broad categories: a modelling system to create 
complex deformable tissues under the heading of the \blob; a high-performance subsystem for 
rendering; a high-performance topology modification algorithm to support cutting and a  
real-time Craniotomy simulation for neurosurgery simulation. The full contributions list is as 
following:

\begin{itemize}
 \item A comprehensive modelling framework supporting a broad set of skeletal implicit primitives, 
 sketched primitive objects, warping, blending, affine transformations and constructive solid geometry 
 operators in the compact \blob structure. Our framework also provides a software architecture for 
 physically-based animation of rigid and deformable models 
 
 \item An algorithm for interactive polygonization of implicit surfaces on multi-core architectures with SIMD instructions.
 \item An optimized GPU-assisted algorithm for high-performance polygonization of implicit surfaces on many-core architectures.
 \item A high-performance algorithm for volume discretization of \blob models which can generate tetrahedral mesh elements with respect to a triangular 
 surface mesh for finite element formulation.
 \item A high-performance algorithm for cutting rigid and deformable tissues interactively.
 \item Smooth cutting of complex volumetric meshes to avoid producing the jagged lines without the 
 need for a post-processing step.

 \item A mesh data-structure suitable for storing dynamic meshes on the GPU to 
 support realtime modifications during cutting
 \item A novel technique for collision detection using implicit fields which is 
 used in our system to detect the intersection of the scalpel tool with the volume mesh in realtime. 
 
  \item Real-time Craniotomy simulation for neurosurgery and biopsy simulations.
\end{itemize}


\section{Overview}
In the next chapter we start by providing background material on implicit modelling technique, the \blob scene-graph and the concept of sketch-based, incremental modelling.
We continue by reviewing the physics properties of the deformable tissues and cover some topics on continuum mechanics concepts and force models used in
our system to achieve non-linear deformations. Chapter \ref{chapter:cpuPoly} presents our rendering framework to visualize complex \blob models using multi-core 
architectures. Building on the outcomes of chapter \ref{chapter:cpuPoly}, the improved results are reviewed in chapter \ref{chapter:GPUDiscretization}. 
The discretization technique to convert a \blob model to a physical system is also given in this chapter. 

In Chapter \ref{chapter:Cutting} we present one of the main contributions of this thesis which is the high performance soft tissue cutting. After a brief overview of the 
related work we present our novel technique in cutting complex soft tissues interactively. Chapter \ref{chapter:evaluation} showcases a skull craniotomy simulation 
scenario and provides comments on the operation itself and the achieved results.

In Chapter \ref{chapter:conclusion} we provide a summary of the results in the previous chapters and reviews the limitations of the current system
and some discussions on the future work in this research topic.


In this research we take into account the requirements of modern surgical 
procedures and introduce a new real-time deformable model with the ability to 
perform real-time topological changes (cutting) in a non-linear model, providing 
more realistic behavior than has can be provided by existing models. 














